<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.2.1" />
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
}

strong {
  font-weight: bold;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1 {
  border-bottom: 2px solid silver;
}
h2 {
  border-bottom: 2px solid silver;
  padding-top: 0.5em;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revision {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble,
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-right: 10%;
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock {
  margin-right: 0%;
}
div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock > div.content {
  padding-left: 2.0em;
}

div.attribution {
  text-align: right;
}
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.verseblock div.content {
  white-space: pre;
}

div.imageblock div.content { padding-left: 0; }
div.imageblock img { border: 1px solid silver; }
span.image img { border-style: none; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: italic;
}
dd > *:first-child {
  margin-top: 0;
}

ul, ol {
    list-style-position: outside;
}
ol.olist2 {
  list-style-type: lower-alpha;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}

div.hlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hlist td {
  padding-bottom: 5px;
}
td.hlist1 {
  vertical-align: top;
  font-style: italic;
  padding-right: 0.8em;
}
td.hlist2 {
  vertical-align: top;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-content {
  padding-left: 2.0em;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
<title>git-home-history(1)</title>
</head>
<body>
<div id="header">
<h1>git-home-history(1)</h1>
</div>
<h2>NAME</h2>
<div class="sectionbody">
<p>git-home-history - a tool to track the history and make backups of
your home directory</p>
</div>
<h2>SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<div class="content"><em>git-home-history</em> init
<em>git-home-history</em> commit
<em>git-home-history</em> show &lt;file&gt; as of &lt;time_spec&gt;
<em>git-home-history</em> eat &lt;file_or_dir&gt;
<em>git-home-history</em> archive-to &lt;file&gt;
<em>git-home-history</em> extract-archive-to &lt;dir&gt;
<em>git-home-history</em> ls-ignored-files
<em>git-home-history</em> ls-stored-files [as of &lt;time_spec&gt;]
<em>git-home-history</em> rm-all
<em>git-home-history</em> rm-older-than &lt;time_spec&gt;</div></div>
</div>
<h2>DESCRIPTION</h2>
<div class="sectionbody">
<p><em>git-home-history</em> is a script that simplifies keeping track of
changes you make in your home directory.  It is based on the excellent
Git toolkit, described at <a href="http://git.or.cz/">http://git.or.cz/</a>.</p>
<p>You should be familiar with Git to use <em>git-home-history</em>.  This
manual explains how you can keep track of your home directory.  It
also shows how you can back up the the entire history of your home
directory to other systems/devices for more safety.</p>
</div>
<h2>OPTIONS</h2>
<div class="sectionbody">
<dl>
<dt>
init
</dt>
<dd>
<p>
       Set up a git repository (<em>.git</em>) and a <em>.gitignore</em> file in
       your home directory.
</p>
</dd>
<dt>
commit
</dt>
<dd>
<p>
       Save your home history to your repository. You can run this
       from wherever you are in the filesystem
</p>
</dd>
<dt>
show &lt;file&gt; as of &lt;time_spec&gt;
</dt>
<dd>
<p>
       Outputs the content of &lt;file&gt;, as stored as of &lt;time_spec&gt;.
</p>
<p>Example:</p>
<div class="listingblock">
<div class="content">
<pre><tt>git-home-history show "myfile.txt" as of 2 days ago
git-home-history show "myfile.txt" as of 1979-02-26 18:30:00</tt></pre>
</div></div>
</dd>
<dt>
archive-to &lt;file&gt;
</dt>
<dd>
<p>
       Outputs a GPG-ed TAR (with suggested extension: .git.tar.gpg)
       to &lt;file&gt;. Note that &lt;file&gt; can be <em>-</em> to send to stdout. The
       archive is encrypted symmetrically with a password.
</p>
<p>Example:</p>
<div class="listingblock">
<div class="content">
<pre><tt>git-home-history archive-to /tmp/home-at-machineX.git.tar.gpg
git-home-history archive-to - \
    | ssh me@remote 'cat &gt; home-machineA.git.tar.gpg'</tt></pre>
</div></div>
</dd>
<dt>
archive-to &lt;file&gt;
</dt>
<dd>
<p>
       Outputs a GPG-ed TAR (with suggested extension: .git.tar.gpg)
       to &lt;file&gt;. Note that &lt;file&gt; can be <em>-</em> to send to stdout. The
       archive is encrypted symmetrically with a password.
</p>
<p>Example:</p>
<div class="listingblock">
<div class="content">
<pre><tt>git-home-history archive-to /tmp/home-at-machineX.git.tar.gpg
git-home-history archive-to - \
    | ssh me@remote 'cat &gt; home-machineA.git.tar.gpg'</tt></pre>
</div></div>
</dd>
<dt>
eat &lt;file_or_dir&gt;
</dt>
<dd>
<p>
       Adds all modifications in file or directory to the history
       store, then removes the file or directory.  Useful to clean up
       the home directory.
</p>
<p>Example:</p>
<div class="listingblock">
<div class="content">
<pre><tt>$ ls
dirA dirB
$ git-home-history eat dirA
$ ls
dirB</tt></pre>
</div></div>
</dd>
<dt>
ls-ignored-files
</dt>
<dd>
<p>
       Shows files that are ignored. To change what should be
       untracked from now on, edit <em>~/.gitignore</em>.  If a file is
       newly ignored, you need to commit before seing it as ignored.
</p>
</dd>
<dt>
ls-stored-files [as of &lt;time_spec&gt;]
</dt>
<dd>
<p>
       Shows all files in the last commit, or, optionally, as of
       <em>time_spec</em>.
</p>
</dd>
<dt>
rm-all
</dt>
<dd>
<p>
       Reinitialize (read <strong>delete all</strong>) <em>~/.git/*</em> and
       <em>~/.gitignore</em>.
</p>
</dd>
<dt>
rm-older-than &lt;time_spec&gt;
</dt>
<dd>
<p>
       Removes all commits older than &lt;time_spec&gt;.  It is a risky
       operation for now.  Not recommended.
</p>
<p>Example:</p>
<div class="listingblock">
<div class="content">
<pre><tt>$ git-home-history rm-older-than 2 days ago
$ git-home-history rm-older-than 1979-02-26 18:30:00</tt></pre>
</div></div>
</dd>
</dl>
</div>
<h2>BASIC USAGE</h2>
<div class="sectionbody">
<p><em>git-home-history</em> is simple to use.  You must first setup your
history store with <tt>git-home-history init</tt>, then tell it what to
ignore from your home directory.  Once this is done, you simply have
to run <tt>git-home-history commit</tt> whenever you want to store the
current state of your home directory in your Git history store.</p>
<p>First, get the script:</p>
<div class="listingblock">
<div class="content">
<pre><tt># Go back to home
$ cd ~

# Download the script
$ wget http://jean-francois.richard.name/git-home-history
# Have a look, to make sure everything is OK!
$ less git-home-history
#!/bin/bash
# [...]

# Make it executable
$ chmod +x git-home-history</tt></pre>
</div></div>
<p>Initializing and doing a first commit is done like this:</p>
<div class="listingblock">
<div class="content">
<pre><tt># Go back to home
$ cd ~

# Ok, let's use it!
# First, create the needed files (in fact, '.git/' and '.gitignore')
$ ./git-home-history init

# The script wants us to edit the .gitignore
# This is an important step to tell what will *not* be
# tracked by git-home-history
$ nano .gitignore

# Check what will be ignored
$ ./git-home-history ls-ignored-files

# Then we make the first commit, which can be a long operation
# depending on the size of your home directory
$ ./git-home-history commit
# ...very long...
# ...zzz...
# Do not worry, the next commits will be blazingly fast!</tt></pre>
</div></div>
<p>Subsequently, saving is very easy.  Simply do <tt>git-home-history
commit</tt> wherever you are in the filesystem.</p>
<p>Example:</p>
<div class="listingblock">
<div class="content">
<pre><tt># (In this example we assume the script 'git-home-history' is stored
# directly under your home directory)

$ cd mywork/blabla/
$ touch testing-testing-mic-check

# Commit the current state!
$ ~/git-home-history commit

$ cd ~/my-other-thing-to-do/
$ touch po-tah-to
$ mv po-tah-to po-tey-to

# Commit the current state!
$ ~/git-home-history commit

# Now you can examine the changes by doing
$ cd ~
$ git-log
# -or, visually-
$ gitk</tt></pre>
</div></div>
</div>
<h2>REMOTE BACKUPS TO SECURE MACHINES</h2>
<div class="sectionbody">
<p>You can use the various Git tools to efficiently clone your history
repository to remote machines <strong>you know and trust</strong> (if not, use the
<tt>archive-to</tt> command to send encrypted tarballs).</p>
<p>For example:</p>
<div class="listingblock">
<div class="content">
<pre><tt># ... do your first commit ... (see section above)

# Go back to home
$ cd ~

# Login to a remote machine and prepare a backup directory
$ ssh myname@remotemachine.net \
    'GIT_DIR=bak-from-machineA.git git-init'

# The following sets up a Git 'remote' shortcut
# See 'man git-push' for more details on remotes and URL formats
$ nano .git/remotes/remotemachine.net

# Add this to your 'remotemachine.net' file :
URL: ssh://myname@remotemachine.net/~myname/bak-from-machineA
Push: master:master


# Now, everytime you whish to copy your history to the
# 'remotemachine.net' remote repository, simply run
$ cd ~
$ git-push remotemachine.net</tt></pre>
</div></div>
<p>Whenever you <tt>git-push</tt>, all the previous commits and associated files
will be copied to the remote place.  Remember to run <tt>git-home-history
commit</tt> before pushing to a remote backup repository if you want the
current state of your home directory to be sent as well.</p>
<p>You can set up multiple remotes and use different transfer schemes
(HTTP, HTTPS, rsync, etc.) depending on your particular needs.  See
the <tt>git-push</tt> man page for more information.</p>
</div>
<h2>STORING HISTORY ON LOCALLY MOUNTED REMOTE DIRECTORY</h2>
<div class="sectionbody">
<p>Since Git stores its data in your home directory, under <em>.git</em>, you
can simply mount a remote filesystem as <em>.git</em> (or symlink to a remote
mount) before initializing the histories.  This will effectively store
the data on the remote filesystem/device (make sure you know and trust
the remote host since it will store all your personal data).</p>
<p>This technique is useful if you do not have sufficient space to
store your history locally.</p>
<p>Example:</p>
<div class="listingblock">
<div class="content">
<pre><tt># ... *do not* initialize and do a first commit *yet* ...
#
# note: see 'Start anew' below if you want to restart...

# Go back to home
$ cd ~

# Plug in your USB device... appears under /media/disk
# ...or have some network filesystem mounted to /media/disk
$ mkdir /media/disk/bak-machineA.git
$ ln -s /media/disk/bak-machineA.git .git

# ... now, do your initialization and first commit (see above)</tt></pre>
</div></div>
</div>
<h2>CLEANING UP THE PAST</h2>
<div class="sectionbody">
<p>Important: this feature is risky to use, for now.  We need a
Git guru to double-check&#8230; (are you one?  care to help?)</p>
<p>You can remove commits that were made before a certain date by using
such commands:</p>
<div class="listingblock">
<div class="content">
<pre><tt>$ ./git-home-history rm-older-than yesterday
$ ./git-home-history rm-older-than 1 month ago
$ ./git-home-history rm-older-than 1 month 2 weeks 3 days 1 hour 1 second ago
$ ./git-home-history rm-older-than 1979-02-26 18:30:00</tt></pre>
</div></div>
<p>This will rewrite the history of commits and may change objects in
your repository.  If you were syncing with git tools (such as
<tt>git-push</tt>), you will probably have to remove the remote repository
and re initialize it.  Really, use at your own risks (for now).</p>
</div>
<h2>STARTING ANEW</h2>
<div class="sectionbody">
<p>You can delete all your previous commits by issuing:</p>
<div class="listingblock">
<div class="content">
<pre><tt>$ ./git-home-history rm-all</tt></pre>
</div></div>
</div>
<h2>AUTOMATIC SCHEDULED COMMITTING</h2>
<div class="sectionbody">
<p>On most UNIX systems, you can simply run, as a user:</p>
<div class="listingblock">
<div class="content">
<pre><tt>$ crontab -e
# You can add this line:
* */2 * * *  /path/to/git-home-history commit &gt;/dev/null 2&gt;&amp;1

# It tells the scheduled commands daemon to run
# 'git-home-history commit' every 2 hours.
# You can make sure it is working by doing (in 2 hours +)
$ cd ~
$ git-log</tt></pre>
</div></div>
</div>
<h2>PRESERVING PERMISSIONS</h2>
<div class="sectionbody">
<p>There is a hook that, at commit, writes all permissions to a special
file, and, at checkout, restores them.  The script is
<tt>contrib/hooks/setgitperms.perl</tt> in the Git source code.  Read the
script itself to know more.  We do not (yet) support it or know much
about it.</p>
</div>
<h2>CAVEATS</h2>
<div class="sectionbody">
<p>If you have Git projects in your home, their contents will not be
stored. Git does not add any subdirectory that contains another Git
repository.</p>
</div>
<h2>DOWNLOADS AND UPDATES</h2>
<div class="sectionbody">
<p>You can grab a copy of the project using Git:</p>
<div class="listingblock">
<div class="content">
<pre><tt>$ git-clone http://jean-francois.richard.name/ghh.git</tt></pre>
</div></div>
<p>You can visit the website at <a href="http://jean-francois.richard.name/ghh/">http://jean-francois.richard.name/ghh/</a>
to stay updated on the development.</p>
</div>
<h2>DISCUSSION</h2>
<div class="sectionbody">
<p>You can visit the group discussion page at
<a href="http://groups.google.com/group/git-home-history">http://groups.google.com/group/git-home-history</a>, and subscribe to
the mailing-list.</p>
</div>
<h2>AUTHORS</h2>
<div class="sectionbody">
<p>Jean-Francois Richard &lt;<a href="mailto:jean-francois@richard.name">jean-francois@richard.name</a>&gt;</p>
</div>
<div id="footer">
<div id="footer-text">
Last updated 09-Dec-2007 11:56:33 EDT
</div>
</div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">_uacct = "UA-541585-5";urchinTracker();</script></body>
</html>
